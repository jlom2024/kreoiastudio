<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KREO IA Studio – Creatividad Humano-IA</title>
  <meta name="description" content="Estudio creativo que fusiona inteligencia artificial y talento humano para proyectos innovadores.">
  <!-- SEO: Meta Keywords (Impacto bajo, pero añadido) -->
  <meta name="keywords" content="KREO IA Studio, inteligencia artificial, creatividad, diseño gráfico, storytelling, memes, sátira política, carteleras, Jorge Ordoñez">
  <meta name="author" content="Jorge Luis Ordoñez M.">

  <!-- Open Graph -->
  <meta property="og:title" content="KREO IA Studio – Creatividad Humano-IA">
  <meta property="og:description" content="Proyectos creativos únicos fruto de la colaboración entre inteligencia artificial y talento humano.">
  <meta property="og:image" content="https://kreoiastudio.netlify.app/images/representacion-burbuja.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="https://kreoiastudio.netlify.app/">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="es_ES">
  <meta property="og:site_name" content="KREO IA Studio">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="KREO IA Studio – Creatividad Humano-IA">
  <meta name="twitter:description" content="Proyectos creativos únicos fruto de la colaboración entre inteligencia artificial y talento humano.">
  <meta name="twitter:image" content="https://kreoiastudio.netlify.app/images/representacion-burbuja.png">

  <link rel="icon" type="image/png" href="favicon.png">

  <!-- Performance: Preload Google Fonts -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap"></noscript>

  <style>
    /* --- ESTILOS BASE Y GENERALES --- */
    body { margin: 0; font-family: 'Open Sans', Arial, sans-serif; background: #000; color: #fff; scroll-behavior: smooth; line-height: 1.6; }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0; }
    /* Accesibilidad: Estilos de Foco Visibles Claros */
    a:focus-visible, button:focus-visible, input:focus-visible, textarea:focus-visible {
        outline: 3px solid #ff8533; /* Naranja brillante */
        outline-offset: 2px;
        box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.7); /* Sombra para contraste */
    }
    /* Quitar outline por defecto si se usa focus-visible */
     a:focus, button:focus, input:focus, textarea:focus {
        outline: none;
     }


    /* --- HEADER --- */
    header { text-align: center; padding: 60px 20px; position: relative; overflow: hidden; min-height: 70vh; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('images/fondo-soñado.jpg') center center / cover no-repeat; z-index: -1; transition: transform 0.1s linear; transform: perspective(1000px) rotateX(var(--header-tilt-x, 0deg)) rotateY(var(--header-tilt-y, 0deg)); will-change: transform; }
    header h1 { font-size: 1.5rem; line-height: 1.2; margin-bottom: 1em; position: relative; z-index: 1; display: flex; flex-direction: column; align-items: center; gap: 0.5em; }
    .header-logo { max-width: 250px; width: 70%; height: auto; display: block; margin: 0; }
    .header-title-text { font-weight: bold; }
    .header-subtitle { font-size: 1.2em; max-width: 600px; margin: 0 auto 1.5em auto; opacity: 1; transition: opacity 0.5s; position: relative; z-index: 1; }
    nav { text-align: center; margin: 40px 0 20px 0; display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; position: relative; z-index: 1; }
    nav a { color: #ff6600; text-decoration: none; font-weight: bold; font-size: 1.2em; padding: 10px; position: relative; transition: color 0.3s ease; cursor: pointer; border-radius: 3px; /* Para que el focus se vea bien */ }
    nav a::after { content: ''; position: absolute; bottom: 0; left: 50%; width: 0; height: 2px; background-color: #ff8533; transition: width 0.3s ease, left 0.3s ease; }
    nav a:hover { color: #ff8533; }
    nav a:hover::after { width: 100%; left: 0; }

    /* --- LOGO PULSANTE --- */
    #pulsating-logo { position: fixed; top: 15px; left: 15px; width: 100px; height: auto; z-index: 1000; animation: pulsate 1.5s ease-in-out infinite; will-change: transform, opacity; }
    @keyframes pulsate { 0% { transform: scale(1); opacity: 0.9; } 50% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); opacity: 0.9; } }

    /* --- MAIN CONTENT Y SECCIONES --- */
    main { display: block; }
    section { max-width: 1000px; margin: auto; padding: 40px 20px; }
    h2 { color: #ff6600; text-align: center; margin-bottom: 30px; font-size: 2em; }

    /* --- SERVICIOS --- */
    .services { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; }
    .service { position: relative; background-size: cover; background-position: center; border-radius: 10px; overflow: hidden; padding: 20px; text-align: center; height: 300px; display: flex; flex-direction: column; justify-content: flex-end; background-repeat: no-repeat; color: white; transition: transform 0.3s ease; }
    .service:hover { transform: scale(1.03); }
    .service::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(0,0,0,0) 50%, rgba(0,0,0,0.8) 100%); border-radius: 10px; z-index: 1; }
    .service h3, .service p { background-color: transparent; margin: 0 0 5px 0; padding: 5px 10px; position: relative; z-index: 2; color: white; text-shadow: 1px 1px 3px rgba(0,0,0,0.7); opacity: 0.4; transition: opacity 0.3s ease, text-shadow 0.3s ease; }
    .service h3 { font-size: 1.3em; margin-bottom: 10px; }
    .service:hover h3, .service:hover p { opacity: 1; text-shadow: 1px 1px 1px rgba(0,0,0,0.9); }

    /* --- CARRUSEL --- */
    .carousel { position: relative; overflow: hidden; max-width: 600px; margin: 40px auto; border-radius: 10px; }
    .carousel-track { display: flex; transition: transform 0.5s ease-in-out; }
    .carousel-track > * { flex-basis: 100%; flex-shrink: 0; box-sizing: border-box; display: flex; justify-content: center; align-items: center; overflow: hidden; }
    .carousel-track img, .carousel-track video { display: block; width: 100%; height: auto; max-width: 100%; object-fit: contain; transition: transform 0.3s ease; }
    .carousel-track img:hover, .carousel-track video:hover { transform: scale(1.02); }
    .carousel-button { position: absolute; top: 50%; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.5); color: white; border: none; padding: 8px 12px; cursor: pointer; border-radius: 50%; font-size: 1.2rem; line-height: 1; z-index: 10; opacity: 0.7; transition: opacity 0.3s ease, background-color 0.3s ease; display: none; }
    .carousel.has-controls .carousel-button { display: block; }
    .carousel:hover .carousel-button { opacity: 0.9; }
    .carousel-button:hover { opacity: 1; background-color: rgba(0, 0, 0, 0.8); }
    .carousel-button.prev { left: 15px; }
    .carousel-button.next { right: 15px; }
    @media (hover: none) and (pointer: coarse) { .carousel.has-controls .carousel-button { opacity: 0.7; } }

    /* --- LOGO MARQUEE --- */
    #logo-strip { padding: 25px 0; background-color: #333; overflow: hidden; width: 100%; box-sizing: border-box; }
    .logo-marquee-container { width: 100%; overflow: hidden; -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); }
    .logo-marquee-track { display: flex; align-items: center; width: fit-content; animation: scrollLogos 40s linear infinite; will-change: transform; }
    #logo-strip:hover .logo-marquee-track { animation-play-state: paused; }
    .partner-logo { height: 80px; width: auto; margin: 0 40px; flex-shrink: 0; opacity: 0.7; filter: grayscale(80%); transition: opacity 0.3s ease, filter 0.3s ease; }
    .partner-logo:hover { opacity: 1; filter: grayscale(0%); }
    @keyframes scrollLogos { 0% { transform: translateX(0%); } 100% { transform: translateX(-50%); } }

    /* --- FORMULARIO DE CONTACTO --- */
    .contact-form { max-width: 400px; margin: auto; display: flex; flex-direction: column; gap: 15px; }
    .contact-form input, .contact-form textarea { padding: 12px; border: 1px solid #2a2a2a; border-radius: 5px; background: #2a2a2a; color: #fff; transition: box-shadow 0.3s ease, border-color 0.3s ease; }
    .contact-form input:focus-visible, .contact-form textarea:focus-visible { /* Usar focus-visible específico */ outline: none; border-color: #ff6600; box-shadow: 0 0 0 3px rgba(255, 102, 0, 0.3); }
    .contact-form button { background: #ff6600; padding: 15px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; color: #fff; font-size: 1em; transition: background-color 0.3s ease, opacity 0.3s ease; }
    .contact-form button:hover { background: #ff8533; }
    .contact-form button:disabled { background: #888; cursor: not-allowed; opacity: 0.7;}
    #contact-status { margin-top: 15px; padding: 10px; border-radius: 5px; text-align: center; font-weight: bold; display: none; }
    #contact-status.success { background-color: #28a745; color: white; }
    #contact-status.error { background-color: #dc3545; color: white; }

    /* --- FOOTER --- */
    footer { text-align: center; padding: 40px 20px; background: #1c1c1c; color: #888; }
    footer p { margin: 8px 0; }
    footer a img { vertical-align: middle; opacity: 0.7; transition: opacity 0.3s ease;}
    footer a:hover img { opacity: 1; }

    /* --- ANIMACIONES --- */
    .reveal { opacity: 0; transform: translateY(20px); transition: opacity 0.8s ease, transform 0.8s ease; will-change: opacity, transform; /* Duración reducida */ }
    .reveal.visible { opacity: 1; transform: none; }
    .fade-in { opacity: 0; transition: opacity 1.5s ease; will-change: opacity; /* Duración reducida */ }
    .fade-in.visible { opacity: 1; }
    @keyframes fadeInRise { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* --- MODAL DE LOGIN --- */
    .modal { display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7); padding-top: 60px; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s ease; will-change: opacity; }
    .modal.show { display: flex; opacity: 1; }
    .modal-content { background-color: #1e1e1e; margin: auto; padding: 30px; border: 1px solid #444; width: 80%; max-width: 400px; border-radius: 8px; position: relative; color: #fff; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.5); transform: scale(0.95); transition: transform 0.3s ease; will-change: transform; }
    .modal.show .modal-content { transform: scale(1); }
    .close-button { color: #aaa; position: absolute; top: 10px; right: 20px; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.2s ease; border-radius: 50%; /* Para que el focus se vea redondo */ }
    .close-button:hover, .close-button:focus { color: #ff6600; text-decoration: none; }
    /* Quitar outline por defecto del botón de cierre */
    .close-button:focus { outline: none; }
    .modal-content h2 { margin-top: 0; color: #ff6600; }
    .modal-content form { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; }
    .modal-content label { text-align: left; font-weight: bold; margin-bottom: -10px; }
    .modal-content input[type="text"], .modal-content input[type="password"] { padding: 12px; border: 1px solid #333; border-radius: 5px; background: #2a2a2a; color: #fff; font-size: 1em; transition: box-shadow 0.3s ease, border-color 0.3s ease; }
    /* Estilo focus-visible específico para inputs de modal */
    .modal-content input:focus-visible { outline: none; border-color: #ff6600; box-shadow: 0 0 0 3px rgba(255, 102, 0, 0.3); }
    .modal-content button { background: #ff6600; padding: 15px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; color: #fff; font-size: 1.1em; transition: background-color 0.3s ease, transform 0.1s ease, opacity 0.3s ease; margin-top: 10px; }
    .modal-content button:hover { background: #ff8533; transform: translateY(-1px); }
    .modal-content button:active { transform: translateY(0px); }
    .modal-content button:disabled { background: #888; cursor: not-allowed; opacity: 0.7;} /* Estado deshabilitado para login */
    #login-error { color: #ff4d4d; margin-top: 15px; font-weight: bold; display: none; }

    /* --- CHATBOT Y ENLACE GPT --- */
    #chatbot-container { display: none; margin: 40px auto; max-width: 600px; padding: 20px; background-color: rgba(27, 27, 27, 0.8); border: 1px solid #333; border-radius: 8px; min-height: 300px; opacity: 0; transition: opacity 0.5s ease-in-out; will-change: opacity; }
    #chatbot-container.visible { opacity: 1; }
    #chatbot-container elevenlabs-convai { width: 100%; border-radius: 5px; overflow: hidden; min-height: 400px; }
    #access-count-display { margin-top: 15px; font-size: 0.85em; color: #999; text-align: center; }
    #gpt-link-container { display: none; margin-top: 25px; padding-top: 15px; border-top: 1px solid #444; text-align: center; }
    #gpt-link-container a { display: inline-block; color: #ff8533; font-weight: bold; text-decoration: none; padding: 10px 18px; border: 1px solid #ff8533; border-radius: 5px; transition: background-color 0.3s ease, color 0.3s ease; }
    #gpt-link-container a:hover { background-color: #ff8533; color: #fff; }
    /* Estilo focus-visible específico para el enlace GPT */
     #gpt-link-container a:focus-visible { outline: 3px solid #fff; outline-offset: 2px; box-shadow: 0 0 0 4px rgba(0,0,0,0.7); background-color: #ff6600; color: #fff; /* Cambiar fondo en focus */ }


    /* --- MEDIA QUERIES --- */
    @media (max-width: 600px) { header { padding: 60px 20px; min-height: 50vh; } header h1 { font-size: 1.3rem; } .header-logo { max-width: 200px; width: 60%; } .header-subtitle { font-size: 1.1em; } nav { gap: 10px; margin-top: 30px; } nav a { font-size: 1.0em; padding: 8px; } h2 { font-size: 1.8em; } #pulsating-logo { width: 80px; } .carousel-track img, .carousel-track video { width: 100%; height: auto; object-fit: contain; } .partner-logo { height: 50px; margin: 0 20px;} .modal-content { width: 90%; padding: 20px; } .modal-content h2 { font-size: 1.5em; } #chatbot-container { max-width: 95%; padding: 15px; margin: 20px auto; min-height: 250px; } section { padding: 30px 15px; } }
    @media (min-width: 992px) { header { min-height: 85vh; justify-content: flex-start; padding-top: 10vh; padding-bottom: 60px; } header::before { background-position: center 35%; } .header-logo { max-width: 350px; width: auto; } header h1 { font-size: 1.8rem; gap: 1em; margin-bottom: 0.8em;} .header-subtitle { animation: fadeInRise 1.2s ease-out 0.3s forwards; margin-bottom: 1.2em; } nav { margin-top: 30px; } #pulsating-logo { width: 150px; top: 20px; left: 20px; } .partner-logo { height: 100px; margin: 0 60px; } .carousel-track img, .carousel-track video { max-height: 550px; width: auto; object-fit: contain; max-width: 100%; } }
  </style>

  <!-- SEO: JSON-LD Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "KREO IA Studio",
    "url": "https://kreoiastudio.netlify.app/",
    "logo": "https://kreoiastudio.netlify.app/images/representacion-burbuja.png",
    "description": "Estudio creativo que fusiona inteligencia artificial y talento humano para proyectos innovadores en áreas como storytelling para marcas, carteleras cinematográficas, memes realistas y sátira política.",
    "founder": {
      "@type": "Person",
      "name": "Jorge Luis Ordoñez M."
    }
  }
  </script>

</head>
<body>
  <!-- Estructura HTML del Body -->
  <img src="images/representacion-burbuja.png" alt="Logo animado KREO IA Studio" id="pulsating-logo" width="150" height="150">
  <header>
    <h1> <img src="LogoR.png" alt="KREO IA Studio Logo" class="header-logo" width="350" height="100"> <span class="header-title-text sr-only">KREO IA Studio – Creatividad Humano-IA</span> </h1>
    <p class="header-subtitle">Innovación a través de la unión del ingenio humano y la creatividad de la Inteligencia Artificial.</p>
    <nav> <a href="#quienes-somos">¿Quiénes Somos?</a> <a href="#servicios">Servicios</a> <a href="#portfolio">Portafolio</a> <a id="asesor-link">Asesor Legal</a> <a href="#contacto">Contacto</a> </nav>
  </header>
  <main>
    <section id="quienes-somos" class="reveal fade-in"> <h2>¿Quiénes Somos?</h2> <p>KREO IA Studio nace del amor entre la inteligencia artificial y el ser humano. Creemos en la colaboración armoniosa entre la creatividad humana y la potencia de la IA, dando lugar a proyectos únicos y llenos de innovación. Cada proyecto es un acto de amor a la creación.</p> </section>
    <section id="servicios" class="reveal"> <h2>Servicios</h2> <div class="services"> <div class="service" style="background-image: url('images/carteleras.jpg');"><h3>Carteleras Cinematográficas</h3><p>Historias visuales que capturan miradas y emociones.</p></div> <div class="service" style="background-image: url('images/satiras.jpg');"><h3>Sátiras Políticas</h3><p>Ironía elegante y crítica inteligente.</p></div> <div class="service" style="background-image: url('images/memes.jpg');"><h3>Memes Realistas</h3><p>Humor visualmente impecable.</p></div> <div class="service" style="background-image: url('images/storytelling.jpg');"><h3>Storytelling para Marcas</h3><p>Relatos visuales que enamoran y venden.</p></div> </div> </section>
    <section id="portfolio" class="reveal">
      <h2>Portafolio</h2>
      <div class="carousel">
        <div class="carousel-track">
          <!-- Ejemplo de optimización con <picture> - NECESITAS CREAR images/img1.webp -->
          <picture>
             <source srcset="images/img1.webp" type="image/webp">
             <img src="images/img1.jpg" alt="Ejemplo de proyecto KREO IA Studio 1 (9:16)" width="338" height="600" loading="lazy">
          </picture>
          <!-- Resto de imágenes (aplicar <picture> si creas los .webp) -->
          <img src="images/img2.jpg" alt="Ejemplo de proyecto KREO IA Studio 2 (9:16)" width="338" height="600" loading="lazy">
          <img src="images/img3.jpg" alt="Ejemplo de proyecto KREO IA Studio 3 (9:16)" width="338" height="600" loading="lazy">
          <img src="images/img4.jpg" alt="Ejemplo de proyecto KREO IA Studio 4 (9:16)" width="338" height="600" loading="lazy">
          <img src="images/img5.jpg" alt="Ejemplo de proyecto KREO IA Studio 5 (9:16)" width="338" height="600" loading="lazy">
          <img src="images/img6.jpg" alt="Ejemplo de proyecto KREO IA Studio 6 (9:16)" width="338" height="600" loading="lazy">
          <video controls preload="metadata" poster="images/img7.jpg" width="338" height="600" loading="lazy" playsinline aria-label="Ejemplo de proyecto KREO IA Studio 7 (Video 9:16)">
              <source src="videos/vid7.mp4" type="video/mp4">
              Tu navegador no soporta la etiqueta de video.
          </video>
          <img src="images/img8.jpg" alt="Ejemplo de proyecto KREO IA Studio 8 (9:16)" width="338" height="600" loading="lazy">
          <img src="images/img9.jpg" alt="Ejemplo de proyecto KREO IA Studio 9 (9:16)" width="338" height="600" loading="lazy">
        </div>
        <button class="carousel-button prev" aria-label="Mostrar slide anterior">❮</button> <!-- Aria-label mejorado -->
        <button class="carousel-button next" aria-label="Mostrar slide siguiente">❯</button> <!-- Aria-label mejorado -->
      </div>
    </section>
    <section id="chatbot-section" aria-labelledby="chatbot-heading" style="padding-top: 0; padding-bottom: 0;">
      <div id="chatbot-container">
        <h2 id="chatbot-heading" style="margin-bottom: 20px;">Asesor Legal IA</h2>
        <elevenlabs-convai agent-id="9d1cgbngGwN9G03G6r0B"></elevenlabs-convai>
        <p id="access-count-display"></p>
        <p id="gpt-link-container" style="display: none;"></p>
      </div>
    </section>
    <section id="logo-strip" aria-labelledby="partners-heading"> <h2 id="partners-heading" class="sr-only">Partners y Clientes</h2> <div class="logo-marquee-container"> <div class="logo-marquee-track"> <!-- Logos --> </div> </div> </section>
    <section id="contacto" class="reveal">
      <h2>Contacto</h2>
      <form id="contact-form" class="contact-form">
        <label for="name" class="sr-only">Tu Nombre</label>
        <input type="text" id="name" name="name" placeholder="Tu Nombre" required>
        <label for="email" class="sr-only">Tu Correo</label>
        <input type="email" id="email" name="_replyto" placeholder="Tu Correo" required>
        <label for="message" class="sr-only">Tu Mensaje</label>
        <textarea id="message" name="message" rows="5" placeholder="Tu Mensaje" required></textarea>
        <button type="submit">Enviar Mensaje</button>
        <p id="contact-status" aria-live="polite"></p>
      </form>
    </section>
  </main>
  <footer> <p>KREO IA Studio © 2025 | Todos los derechos reservados</p> <p>Ficción IA: arte, sátira y humor. Parecido a la realidad es coincidencia.</p> <p>Visítanos en Tiktok:</p> <a href="https://www.tiktok.com/@kreo_ai_studio" target="_blank" rel="noopener noreferrer" aria-label="Visita nuestro perfil de TikTok"> <img src="images/tiktok-icon.png" alt="TikTok" width="24" height="24" style="filter: grayscale(30%); transition: filter 0.3s ease;"> </a> </footer>
  <div id="login-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="login-heading">
     <div class="modal-content">
        <span class="close-button" id="close-login-modal" aria-label="Cerrar diálogo de acceso" role="button" tabindex="0">×</span> <!-- Aria-label mejorado -->
        <h2 id="login-heading">Acceso Asesor Legal</h2>
        <form id="login-form" novalidate>
           <label for="username">Usuario:</label> <input type="text" id="username" name="username" required placeholder="Introduce tu usuario" aria-required="true">
           <label for="password">Contraseña:</label> <input type="password" id="password" name="password" required placeholder="Introduce tu contraseña" aria-required="true">
           <button type="submit">Ingresar</button>
           <p id="login-error" role="alert" aria-live="assertive">Usuario o contraseña incorrectos.</p>
        </form>
     </div>
  </div>

<!-- ================================== -->
<!-- === SCRIPT COMPLETO RESTAURADO Y OPTIMIZADO === -->
<!-- ================================== -->
<script>
document.addEventListener('DOMContentLoaded', () => {

  // --- GRUPO: Funciones Utilitarias ---
  const getAccessCounts = () => { try { const c = localStorage.getItem('userAccessCounts'); return c ? JSON.parse(c) : {}; } catch (e) { console.error("LS Read Error:", e); return {}; } };
  const saveAccessCounts = (c) => { try { localStorage.setItem('userAccessCounts', JSON.stringify(c)); } catch (e) { console.error("LS Write Error:", e); } };

  // --- GRUPO: Efecto Tilt del Header ---
  const header = document.querySelector('header');
  if (header && window.matchMedia('(pointer: fine)').matches) {
    const maxTilt = 6;
    let rafId = null;
    header.addEventListener('mousemove', (e) => {
      if(rafId) cancelAnimationFrame(rafId); // Optimización: cancelar frame anterior
      rafId = requestAnimationFrame(() => {
          const rect = header.getBoundingClientRect(); const x = e.clientX - rect.left; const y = e.clientY - rect.top;
          const width = header.offsetWidth; const height = header.offsetHeight; const normX = (x / width) - 0.5; const normY = (y / height) - 0.5;
          const tiltY = normX * maxTilt; const tiltX = -normY * maxTilt;
          header.style.setProperty('--header-tilt-x', `${tiltX}deg`); header.style.setProperty('--header-tilt-y', `${tiltY}deg`);
      });
    });
    header.addEventListener('mouseleave', () => {
      if(rafId) cancelAnimationFrame(rafId);
      requestAnimationFrame(() => { header.style.setProperty('--header-tilt-x', '0deg'); header.style.setProperty('--header-tilt-y', '0deg'); });
    });
  }

  // --- GRUPO: Lógica del Carrusel ---
  const carousel = document.querySelector('.carousel');
  if (carousel) {
      const track = carousel.querySelector('.carousel-track'); const prevButton = carousel.querySelector('.carousel-button.prev'); const nextButton = carousel.querySelector('.carousel-button.next');
      const slides = track ? Array.from(track.children) : []; const videoSlides = track ? track.querySelectorAll('video') : [];
      if (track && prevButton && nextButton && slides.length > 0) {
          let slideWidth = 0; let currentIndex = 0; let autoPlayInterval = null; const autoPlayDelay = 5000; let resizeTimer;
          const updateSlideWidthAndPosition = () => { if (slides.length === 0) return; const carouselRect = carousel.getBoundingClientRect(); const newSlideWidth = carouselRect.width; if (newSlideWidth > 0) { slideWidth = newSlideWidth; slides.forEach(slide => slide.style.flexBasis = `${slideWidth}px`); track.style.transition = 'none'; moveToSlide(currentIndex); void track.offsetWidth; track.style.transition = 'transform 0.5s ease-in-out'; } };
          const moveToSlide = (index) => { if (slideWidth <= 0 || slides.length === 0) return; const currentSlideElement = slides[currentIndex]; const videoInCurrentSlide = currentSlideElement?.querySelector('video'); if (videoInCurrentSlide && !videoInCurrentSlide.paused) { try { videoInCurrentSlide.pause(); } catch (error) { console.warn("Vid pause error:", error); } } const newIndex = (index + slides.length) % slides.length; const moveAmount = slideWidth * newIndex; track.style.transform = `translateX(-${moveAmount}px)`; currentIndex = newIndex; };
          const showPrevSlide = () => { stopAutoPlay(); moveToSlide(currentIndex - 1); }; const showNextSlide = () => { stopAutoPlay(); moveToSlide(currentIndex + 1); };
          const startAutoPlay = () => { stopAutoPlay(); if (slides.length > 1) { autoPlayInterval = setInterval(() => moveToSlide(currentIndex + 1), autoPlayDelay); } }; const stopAutoPlay = () => { clearInterval(autoPlayInterval); autoPlayInterval = null; };
          if (slides.length > 1) { carousel.classList.add('has-controls'); prevButton.addEventListener('click', showPrevSlide); nextButton.addEventListener('click', showNextSlide); carousel.addEventListener('mouseenter', stopAutoPlay); carousel.addEventListener('mouseleave', () => { const currentVideo = slides[currentIndex]?.querySelector('video'); if (!currentVideo || currentVideo.paused) { startAutoPlay(); } }); videoSlides.forEach(video => { video.addEventListener('play', stopAutoPlay); video.addEventListener('pause', () => { if (!carousel.matches(':hover')) { startAutoPlay(); } }); }); startAutoPlay(); } else { carousel.classList.remove('has-controls'); }
          window.addEventListener('resize', () => { clearTimeout(resizeTimer); resizeTimer = setTimeout(updateSlideWidthAndPosition, 250); }); window.addEventListener('load', () => setTimeout(updateSlideWidthAndPosition, 100)); setTimeout(updateSlideWidthAndPosition, 50);
      } else if (slides.length <= 1) { if(prevButton) prevButton.style.display = 'none'; if(nextButton) nextButton.style.display = 'none'; } else { console.warn("Carousel elements not found."); }
  }

  // --- GRUPO: Animaciones de Revelación al Scroll ---
  const revealElements = document.querySelectorAll('.reveal');
  if ('IntersectionObserver' in window) {
      const observerOptions = { root: null, threshold: 0.15, rootMargin: '0px 0px -50px 0px' };
      const observerCallback = (entries, observer) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); /* observer.unobserve(entry.target); */ } else if (!entry.target.classList.contains('fade-in')) { /* entry.target.classList.remove('visible'); */ } }); };
      const revealObserver = new IntersectionObserver(observerCallback, observerOptions); revealElements.forEach(el => revealObserver.observe(el));
      const fadeInElements = document.querySelectorAll('.fade-in'); const fadeInObserver = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); /* fadeInObserver.unobserve(entry.target); */ } }); }, { threshold: 0.1 }); fadeInElements.forEach(el => fadeInObserver.observe(el));
  } else { console.warn("IntersectionObserver not supported."); revealElements.forEach(el => el.classList.add('visible')); document.querySelectorAll('.fade-in').forEach(el => el.classList.add('visible')); }

  // --- GRUPO: Lógica de Login (Asesor Legal) ---
  const validCredentials = { "KOKO2025": "2025KOKO", "otro_cliente": "kreo_acceso" };
  const asesorLink = document.getElementById('asesor-link'); const loginModal = document.getElementById('login-modal');
  const closeModalButton = document.getElementById('close-login-modal'); const loginForm = document.getElementById('login-form');
  const usernameInput = document.getElementById('username'); const passwordInput = document.getElementById('password');
  const loginError = document.getElementById('login-error'); const chatbotContainer = document.getElementById('chatbot-container');
  const accessCountDisplay = document.getElementById('access-count-display');
  const gptLinkContainer = document.getElementById('gpt-link-container');
  const formspreeLoginEndpoint = 'https://formspree.io/f/mkgronyd'; // Endpoint para notificaciones de login
  const loginSubmitButton = loginForm ? loginForm.querySelector('button[type="submit"]') : null; // Referencia al botón de login

  // Mostrar modal de login
  if (asesorLink && loginModal) {
      asesorLink.addEventListener('click', (event) => {
          event.preventDefault();
          if(loginError) loginError.style.display = 'none';
          if(loginForm) loginForm.reset();
          if(gptLinkContainer) gptLinkContainer.style.display = 'none'; if(gptLinkContainer) gptLinkContainer.innerHTML = '';
          loginModal.classList.add('show');
          if (usernameInput) setTimeout(() => usernameInput.focus(), 50);
      });
  }

  // Ocultar modal de login
  const hideLoginModal = () => { if(loginModal) loginModal.classList.remove('show'); };
  if (closeModalButton) closeModalButton.addEventListener('click', hideLoginModal);
  if (loginModal) { loginModal.addEventListener('click', (event) => { if (event.target === loginModal) hideLoginModal(); }); loginModal.addEventListener('keydown', (event) => { if (event.key === 'Escape') hideLoginModal(); }); }

  // Manejar envío del formulario de login
  if (loginForm && loginModal && chatbotContainer && gptLinkContainer && loginSubmitButton) {
      loginForm.addEventListener('submit', (event) => {
          event.preventDefault();
          const enteredUsername = usernameInput.value.trim();
          const enteredPassword = passwordInput.value;
          const submitButtonOriginalText = loginSubmitButton.textContent; // Guardar texto original

          // UX: Mostrar estado de carga en botón
          loginSubmitButton.disabled = true;
          loginSubmitButton.textContent = 'Ingresando...';
          if(loginError) loginError.style.display = 'none'; // Ocultar error previo

          // Pequeño delay simulado (opcional, quitar si la validación es instantánea)
          setTimeout(() => {
              if (validCredentials[enteredUsername] && validCredentials[enteredUsername] === enteredPassword) {
                  // --- LOGIN EXITOSO ---
                  hideLoginModal();
                  chatbotContainer.style.display = 'block';
                  setTimeout(() => chatbotContainer.classList.add('visible'), 10);

                  const accessCounts = getAccessCounts(); accessCounts[enteredUsername] = (accessCounts[enteredUsername] || 0) + 1; saveAccessCounts(accessCounts);
                  if (accessCountDisplay) { accessCountDisplay.textContent = `(Sesión local #${accessCounts[enteredUsername]} para ${enteredUsername})`; }

                  const gptUrl = 'https://chatgpt.com/g/g-680eaf03ebb481919cd175779b914629-doctor-jorge'; gptLinkContainer.innerHTML = ''; const gptLink = document.createElement('a'); gptLink.href = gptUrl; gptLink.textContent = 'Abrir Asistente Avanzado (GPT)'; gptLink.target = '_blank'; gptLink.rel = 'noopener noreferrer'; gptLinkContainer.appendChild(gptLink); gptLinkContainer.style.display = 'block';

                  const loginData = new FormData(); const now = new Date(); loginData.append('_subject', `Acceso KREO Asesor: ${enteredUsername}`); loginData.append('Usuario', enteredUsername); loginData.append('Fecha_Hora_UTC', now.toISOString()); fetch(formspreeLoginEndpoint, { method: 'POST', body: loginData, headers: { 'Accept': 'application/json' } }).then(response => { if (!response.ok) { console.error('Formspree Error:', response.status); } }).catch(error => console.error('Network Error (Formspree):', error));

                  // Scroll al Chatbot
                  setTimeout(() => { if (chatbotContainer) { chatbotContainer.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'nearest' }); } else { console.error("Cannot scroll, chatbotContainer not found."); } }, 300); // Reducido delay si el contenedor ya tiene min-height

              } else {
                  // --- LOGIN FALLIDO ---
                  if(loginError) loginError.style.display = 'block';
                  if(passwordInput) passwordInput.value = '';
                  if(usernameInput) usernameInput.select();
                  if (navigator.vibrate) { navigator.vibrate(100); }
                  if(gptLinkContainer) gptLinkContainer.style.display = 'none'; if(gptLinkContainer) gptLinkContainer.innerHTML = '';
              }
              // Restaurar botón después del intento
               loginSubmitButton.disabled = false;
               loginSubmitButton.textContent = submitButtonOriginalText;

          }, 250); // Fin del delay simulado (ajustar o quitar)

      });
  } else { /* Logs de elementos no encontrados */ if(!loginForm) console.error("Login form not found."); if(!loginModal) console.error("Login modal not found."); if(!chatbotContainer) console.error("Chatbot container not found."); if(!gptLinkContainer) console.error("GPT Link Container not found."); if(!loginSubmitButton) console.error("Login submit button not found."); }


  // --- GRUPO: Lógica para Formulario de Contacto con AJAX ---
  const contactForm = document.getElementById('contact-form');
  const contactStatus = document.getElementById('contact-status');
  const contactSubmitButton = contactForm ? contactForm.querySelector('button[type="submit"]') : null;
  const formspreeContactEndpoint = 'https://formspree.io/f/mkgronyd'; // Endpoint para CONTACTO

  if (contactForm && contactStatus && contactSubmitButton) {
    contactForm.addEventListener('submit', function(event) {
      event.preventDefault();
      const formData = new FormData(contactForm);
      const submitButtonOriginalText = contactSubmitButton.textContent;
      contactStatus.textContent = 'Enviando mensaje...'; contactStatus.className = ''; contactStatus.style.display = 'block';
      contactSubmitButton.disabled = true; contactSubmitButton.textContent = 'Enviando...';

      fetch(formspreeContactEndpoint, { method: 'POST', body: formData, headers: { 'Accept': 'application/json' } })
      .then(response => {
        contactSubmitButton.disabled = false; contactSubmitButton.textContent = submitButtonOriginalText;
        if (response.ok) { contactStatus.textContent = '¡Mensaje enviado con éxito! Gracias.'; contactStatus.className = 'success'; contactForm.reset(); /* setTimeout(() => { contactStatus.style.display = 'none'; }, 5000); */ }
        else { response.json().then(data => { let errorMsg = 'Hubo un problema al enviar el mensaje.'; if (data && data.errors) { errorMsg += ' Errores: ' + data.errors.map(e => e.message).join(', '); } contactStatus.textContent = errorMsg; contactStatus.className = 'error'; }) .catch(() => { contactStatus.textContent = 'Hubo un problema al enviar el mensaje. Respuesta no válida del servidor.'; contactStatus.className = 'error'; }); }
      })
      .catch(error => { contactSubmitButton.disabled = false; contactSubmitButton.textContent = submitButtonOriginalText; contactStatus.textContent = 'Error de red. Por favor, revisa tu conexión e intenta de nuevo.'; contactStatus.className = 'error'; console.error('Error en fetch de contacto:', error); });
    });
  } else { /* Logs de elementos no encontrados */ if(!contactForm) console.error("Contact form not found."); if(!contactStatus) console.error("Contact status element not found."); if(!contactSubmitButton) console.error("Contact submit button not found."); }

}); // Fin de document.addEventListener('DOMContentLoaded')
</script>

<!-- Script de ElevenLabs Activado -->
<script src="https://elevenlabs.io/convai-widget/index.js" async type="text/javascript"></script>

</body>
</html>